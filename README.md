# Vulnerability Management with OpenVAS
![OpenVAS](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/1.png)


## Summary and Purpose

In this project, a secure Azure network was created and populated with two virtual machines, set to run OpenVAS Vulnerability Management Scanner and Windows 10. The Windows 10 virtual machine was made vulnerable by disabling security controls and installing outdated software. 

To highlight the significance of properly configuring vulnerability scans, two types of scans were conducted. First, an unauthenticated scan was performed on the Windows 10 machine. Following the completion of the unauthenticated scan, a credentialed scan was configured and initiated. Based on the results of the credentialed scan, remediations were implemented to mitigate major vulnerabilities. 

A final credentialed scan was conducted to verify the effectiveness of the implemented remediations.


## Technologies, Azure Components, and Regulations Used

- Azure Virtual Network
- OpenVAS Vulnerability Management Scanner
- Windows 10 Pro virtual machine
- Outdated software, known to have vulnerabilities
  - Mozilla Firefox, v97.0b5
  - VideoLAN VLC Media Player, v1.1.7
  - Adobe Reader, v10.0.0


## Deploy Resources and Configure Virtual Machines for an Unauthenticated Scan

The first resource created in this project was OpenVAS Vulnerability Management Scanner. Specifically, OpenVas by HOSSTED was utilized with a default developer configuration. While OpenVAS installed, a Windows 10 Pro virtual machine was created. 

To prepare the Windows 10 machine, the firewall was disabled and outdated versions of Firefox, VLC Media Player, and Adobe Reader were installed. The goal was for the Windows 10 machine to be blatantly vulnerable. Once the firewall was disabled and the vulnerable software was installed, the machine was restarted.


![4 Disable firewall](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/2.png)


<br>To configure OpenVAS for an unauthenticated scan, the following steps were completed:

1. A new host was created by using the Windows 10 virtual machine’s private IP Address.


![1 BEFORE_Uncredentialed host](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/3.png)


2. A new target was created, using the host from the previous step. All other configurations were left as default and no credentials were provided to OpenVAS.


![2 BEFORE_Uncredentialed target](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/4.png)


3. A new task was created with the target from the previous step. Again, all other configurations were left as default for this sca.


![3 BEFORE_Uncredentialed task](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/5.png)



##  Results of the Unauthenticated Scan

Due to the scan being unauthenticated, the vulnerabilities found do not accurately reflect the vulnerabilities known to be on the machine. The outdated software on the virtual machine is not reflected in this scan due to the limited capabilities inherent in unauthenticated scans.


![5 BEFORE_Uncredentialed overview](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/5.5.png)
![6 BEFORE_Uncredentialed reports](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/6.png)


## Configure Windows 10 for a Credentialed Scan

To configure the Windows 10 machine for a credentialed scan, several changes needed to be made. The first step was to verify the Domain, Private, and Public profiles for Windows Firewall were still disabled from the intiial configruation.

The following steps were then completed:

1. Disable User Account Control.


![7 disable user account control](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/7.png)


2. Enable Remote Registry.


![remote registry](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/8.png)


3. Navigate to the Windows Registry and create a new DWORD named “LocalAccountTokenFilterPolicy” and set the value to “1”.


![8 regedit](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/9.png)


4. Restart the virtual machine.


## Configure OpenVAS for a Credentialed Scan

While the Windows 10 machine restarted, the following steps were completed to configure OpenVAS for a credentialed scan:

1. Create a new credential by providing the Windows 10 virtual machine’s username and password to OpenVAS.


![9 configure credential](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/10.png)


2. Clone the existing target by clicking the sheep icon found under “Actions.” Edit the cloned target and enable SMB by selecting the credentials created in the previous step.


![10 CLONE highlight](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/10.5.png)
![11 clone target](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/11.png)



3. Clone the existing task and edit the clone to use the credentialed target created in the previous step.


![12 Credentialed scan clone](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/12.png)


## Results of the Credentialed Scan

The difference in vulnerabilities discovered during the unauthenticated and credentialed scans is immediately apparent. Not only did the severity rating change from 5.0 (medium) to 10.0 (high), but the credentialed scan returned 107 additional vulnerabilities. 

The credentialed scan allowed OpenVAS to fully evaluate the system, which included identifying vulnerabilities in the outdated software. To learn more about the vulnerabilities, OpenVAS provides a tab for Common Vulnerabilities and Exposure (CVE). By including CVEs, OpenVAS allows for an easily digestible breakdown of each vulnerability. The breakdown provided includes a description, the score, vector, references, and remediations.


![13 Credentialed overview](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/13.png)
![14 Credentialed reports](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/14.png)
![15 Credentialed CVE](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/15.png)
![16 CVE Info](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/16.png)



## Remediation, Verification Scan, and Conclusion

To remediate the majority of the vulnerabilities found during the credentialed scan, the outdated software was uninstalled from the Windows 10 machine. Another credentialed scan was performed to verify the implemented remediations resolved the expected vulnerabilities. 

Based on the scan, the remediations were successful and a downward trend in vulnerabilities was shown. By removing the outdated software, the amount of vulnerabilities found by OpenVAS was reduced by 91.


![17 after overview](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/17.png)
![18 after reports](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/18.png)
![19 after cve](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/19.png)
![20 cve info](https://github.com/FUenal/Vulnerability-Management-with-OpenVAS/blob/main/assets/20.png)


This project successfully demonstrated the configuration of OpenVAS and the subsequent remediation of vulnerabilities. The project also demonstrated the importance of conducting credentialed scans when possible, as an unauthenticated scan does not accurately reflect the security of a system. Even though additional high severity vulnerabilities remained on the verification scan, remediating those vulnerabilities was not within the scope of this project.


## Reflection
This project was designed to give me hands-on experience with vulnerability management, to include configurations and remediations. In the future, I plan to conduct this project again with the intent of focusing on advanced vulnerability remediation.

